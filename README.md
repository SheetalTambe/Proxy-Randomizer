# Proxy-Randomizer
I created Proxy randomizer function which is used for web scrapers/crawlers, helping to avoid temporal/permanent bans from web pages, generating random proxies to include in the requests.

# What is Web scraping?

Web scraping, web harvesting, or web data extraction is data scraping used for extracting data from websites.

# What is proxy?

A proxy is a server that acts as an intermediary between your computer and the internet. When you connect to the internet through a proxy, your online activities are hidden from your ISP and other third parties. Proxies are often used for web scraping because they can help to bypass restrictions placed on websites.

There are two main types of proxies: public proxies and private proxies. Public proxies can be used by anyone and are usually free to use. Private proxies are only accessible by authorized users and typically come with a fee.

Here we are using proxy set. It can be anything public proxies or private proxies, which is saved in text file.

Use below format to save proxies into file,

PROXY_IP | PROXY_PORT| Proxy_UserName | Proxy_PassW

e.g: 00000|80|abc|xyz

# Below are the steps to use random proxy function.

open VBA editor > new module and start writing code in a sub.

    Public sub ProxyRandmozierFunction()
    End Sub

               
# Define Counter

    ForReading1 = 1                            // Defined a reading Counter for reading proxy from 1st index
    
#Mention FileSystemObject (FSO)

FileSystemObject (FSO) allows you to access the file system of your computer. Using it, you can access and modify the files/folders/directories in your computer system.
	
    Set objFSO = CreateObject("Scripting.FileSystemObject")
    Set objTextFile = objFSO.OpenTextFile("E:\Proxy.txt", ForReading1)       //   Mentioned location/path of proxy file to open.
    
	  objTextFile.ReadAll     // read all the proxies present in file and close file.
   
	  TotalNoOfProxy = objTextFile.Line    // assigning value to variable to store total proxies count present in file.
   
	  Do While websiteStatus <> 200
        	Randomize
        	pcnt = Round((TotalNoOfProxy - 1) * Rnd() + 1, Decimals)  	//  round function will generate random number and will store that value in pcnt variable
       	  LineCount1 = pcnt     	     //  re- storing that value to another variable.
    Set objTextFile = objFSO.OpenTextFile("E:\Proxy.txt", ForReading1)  	// again opening the proxy.txt file 
           For i = 1 To (LineCount1 - 1)
        	 objTextFile.SkipLine
        	 Next
    strLine = objTextFile.ReadLine()	  	// this loop will read the proxy present at number generated by random function.
    
	  IPPort = Split(strLine, "|")		// Split the proxy line using | operator
   
    PROXY_IP = IPPort(0): PROXY_PORT = IPPort(1): Proxy_UserName = IPPort(2): Proxy_PassW = IPPort(3)		//  separate proxy line  through index
    
    objTextFile.Close			// close the file.



# Define XMLHttpRequest

Define http client using following code


    Dim xmlhttp as object
    Set xmlhttp = Nothing
    Set xmlhttp = CreateObject("MSXML2.ServerXMLHTTP.6.0")
    

# Make requests
Requests can be made using open and send methods. Open method syntax is as follows :

    xmlhttp.Open Method, URL, true or false    //replace with your URL

# define proxy
    xmlhttp.setProxy 2, PROXY_IP & ":" & PROXY_PORT
    xmlhttp.setProxyCredentials Proxy_UserName, Proxy_PassW   // it will take random proxy 

# Request headers

Request headers can be set using setRequestHeader method.

    Call xmlhttp.setRequestHeader("Accept", "text/html, application/xhtml+xml, */*")
    Call xmlhttp.setRequestHeader("Accept-Language", "en-US")
    Call xmlhttp.setRequestHeader("User-Agent", "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko")
    Call xmlhttp.setRequestHeader("Host", "es-store.acer.com")
    Call xmlhttp.setRequestHeader("Proxy-Connection", "Keep-alive")
    Call xmlhttp.setRequestHeader("content-type", "text/html; charset=UTF-8")

# Send request to server

    xmlhttp.send  // send method will send request to method
    
        websiteStatus = xmlhttp.Status    // it will check website status
        If websiteStatus = 200 Then Exit Do
        Loop
        websiteStatus = ""
# store request response recived from server
        
        strHTML = xmlhttp.responseText    // it will save the url response into strHTML variable.
          
        Call WriteVarToDisk(Strhtml, "data.html")    // this function will store the resonse of URL to computer device 

    



       
